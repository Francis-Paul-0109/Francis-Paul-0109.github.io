<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>{{ page.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #1A1A1A;
      color: #FFFFFF;
      overflow-x: hidden;
      font-family: "MyHeaderFont", sans-serif;
    }

    /* 좌측 이미지 */
    .fixed-image {
      position: fixed;
      top: 50%;
      left: 5%;
      transform: translateY(-50%);
      width: 30%;
      max-width: 350px;
      z-index: 5;
      pointer-events: none;
    }
    .fixed-image img {
      width: 100%;
      border-radius: 10px;
      opacity: 0;
      transition: opacity 0.4s ease-in-out;
    }

    /* 우측 텍스트 */
    .scrolly-text {
      width: 90%;
      margin-left: 15%;
      padding-top: 0vh;
      padding-bottom: 4rem;
      font-size: 1.15rem;
      line-height: 1.7;
      white-space: pre-line;
    }

    .step {
      margin: 80vh 0;
      opacity: 0;
      transform: translateY(30px);
    }

    .step.active {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    .highlight-keyword {
      font-weight: bold;
      color: #ff9800;
    }
  </style>
</head>

<body>

  <div class="fixed-image">
    <img id="auto-img" src="">
  </div>

  <div class="scrolly-text">
    <!-- md 내용 자동 렌더링 -->
   {{ content }}
  </div>

  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.15.0/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.15.0/ScrollTrigger.min.js"></script>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    const steps = document.querySelectorAll(".step");
    const img = document.getElementById("auto-img");

    // 초기
    if (steps.length > 0) {
      steps[0].classList.add("active");
      img.src = "/assets/images/{{ page.slug }}/" + steps[0].dataset.img;
      img.style.opacity = 1;
    }

    steps.forEach(step => {
      ScrollTrigger.create({
        trigger: step,
        start: "top 70%",
        end: "bottom 30%",
        onEnter: () => activate(step),
        onEnterBack: () => activate(step)
      });
    });

    function activate(step) {
      const newImg = step.dataset.img;

      if (img.src.indexOf(newImg) === -1) {
        gsap.to(img, { opacity: 0, duration: 0.4, onComplete: () => {
          img.src = "/assets/images/{{ page.slug }}/" + newImg;
          gsap.to(img, { opacity: 1, duration: 0.4 });
        }});
      }

      steps.forEach(s => s.classList.remove("active"));
      step.classList.add("active");
    }
  </script>

</body>
</html>
